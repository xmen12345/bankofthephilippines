jQuery(document).delegate(".aa-tabLabel","click",function(){var b=this.getAttribute("for")||this.getAttribute("data-for");if(b){var a=jQuery(this).parents(":has(.aa-tabs)");if(a.length){jQuery(".aa-tabLabel, .aa-tab",a[0]).removeClass("aa-activeTab");jQuery(b,a[0]).addClass("aa-activeTab");jQuery(this).addClass("aa-activeTab")}}});window.be=window.be||{};window.bd=window.bd||{};be.utils=(function(window,$){var cache={},loads=0,to,notification,DEFAULT_AJAX_TIMEOUT=60000,MSG_PROCESSING="processing...",MSG_TIMEOUT="Request to the server has timed out. Please try again.",contextRoot=be.contextRoot||bd.contextRoot||(b$.portal&&b$.portal.config&&b$.portal.config.serverRoot)||"",getURLRoot,getTemplateDataFromForm,getDateString,domReady,domJsReady,loadTemplate,loadTemplateByUrl,loadTemplateByDifferentUrl,loadCSSByUrl,inProgress,showLoadMessage,_showLoadMessage,hideLoadMessage,isIgnoredCall,ajax,processHTMLTemplateByUrl,processHTMLTemplate,processXMLTemplate,processXMLTemplateByUrl,processTemplate,removeNonAlphaNumericChars,trimString,replaceRefuzingChars,formatAllowedName,formatAllowedFriendlyUrl,formatAllowedPath,formatAllowedTitle,xmlEscape,replacePlaceHolders,replaceParams,xpathSingleNode,xpathSetSingleNodeValue,xpathNodes,xml2text,removeSelectedOption,getSelectionValue,resetFormValues,insertOption,alert,confirm,cssClass,unique,delay,CustomMethodForValidator,addCustomMethodToValidator,ISODateString,fromISO,truncateText,bytesToSize,mergeJsonObj,getWindowSize,varicalPagination,log,serializeJSON,convertToArray,getNodeText,digitString,isString,stripHTML,isInteger,formatDate,daysInMonth,getTagContents,getCursor,nodesWrapper,clickOutside,resetOutside,isDebugging,testDelay,makeDelayedCall,mattsTest,ericsTest,notifier,calcImageSize,tryCatch,autoScroll,getBoxObject,isBrowserDetected,browserDetection,module,define,getQueryStringParam,getErrorText,padDigits,startModule,parseParamsToObject,isType,filterItems,serverStatus,throttle;var XSRF_COOKIE="BBXSRF";var XSRF_REQUEST_HEADER="X-BBXSRF";getURLRoot=function(){var urlRoot=window.location.protocol+"//"+window.location.hostname;if(window.location.port===""||window.location.port===80||window.location.port===43){return urlRoot}urlRoot+=":"+window.location.port;return urlRoot};getTemplateDataFromForm=function(formSelector){var templateData={},tempArray=jQuery(formSelector).serializeArray();jQuery.each(tempArray,function(index,field){templateData[field.name]=field.value});return templateData};getDateString=function(sDate){console.log("be.utils.getDateString is deprecated.  Please use: bd.date.formatDateTime(timestamp)");var nMillisecondsInOneDay,nNowTime,oDate,sTimePart,sDatePart;nMillisecondsInOneDay=1000*60*60*24;nNowTime=new Date().getTime();oDate=new Date();oDate.setTime(Date.parse(sDate));sTimePart=(oDate.getHours()>9?oDate.getHours():"0"+oDate.getHours())+":"+(oDate.getMinutes()>9?oDate.getMinutes():"0"+oDate.getMinutes());if(nNowTime-oDate.getTime()<nMillisecondsInOneDay){sDatePart="Today"}else{if(nNowTime-oDate.getTime()<2*nMillisecondsInOneDay){sDatePart="Yesterday"}else{sDatePart=oDate.toDateString()}}return sDatePart+", "+sTimePart};domReady=function(selector,successCallback,failedCallback,tries){var timeout=null;tries=(tries==null)?1:tries;timeout=setTimeout(function retry(){var el=jQuery(selector);if(el.length!==0){clearTimeout(timeout);successCallback(el)}if(tries>25){clearTimeout(timeout);if(failedCallback!=null){failedCallback()}}++tries;setTimeout(retry,50)},50)};domJsReady=function(test,successCallback,failedCallback,tries,speed){var timeout=null;tries=(tries==null)?1:tries;speed=(speed==null)?50:speed;timeout=setTimeout(function retry(){var returnOutput=null;try{returnOutput=eval(test)}catch(exception){clearTimeout(timeout);console.log("exception: "+exception);if(failedCallback!=null){failedCallback(exception)}}if(returnOutput===true||returnOutput==="true"){clearTimeout(timeout);successCallback()}if(tries>25){clearTimeout(timeout);if(failedCallback!=null){failedCallback()}}++tries;setTimeout(retry,speed)},speed)};loadTemplate=function(templateName,templateType,async){return loadTemplateByUrl(contextRoot+"/static/dashboard/templates/"+templateType+"/"+templateName+"."+templateType,async)};loadTemplateByUrl=function(url,async){var dfd=$.Deferred(),htmlContent="",promise;if(cache[url]){htmlContent=$.data(document.body,url);promise=dfd.resolve(htmlContent)}else{promise=ajax({url:url,async:async||false,success:function(data){$.data(document.body,url,data);cache[url]=true;htmlContent=data},error:function(jqXHR){if(jqXHR.status==="404"){htmlContent=loadTemplateByDifferentUrl(url,async)}}})}return async?promise:htmlContent};loadTemplateByDifferentUrl=function(url,async,templateType){var htmlContent="",tmpUrl,promise;templateType=templateType||"html";tmpUrl=contextRoot+"/static/dashboard/templates/"+templateType+"/"+url+"."+templateType;promise=ajax({url:tmpUrl,async:async||false,success:function(data){htmlContent=data}});return async?promise:htmlContent};inProgress=false;showLoadMessage=function(){clearTimeout(to);loads+=1;to=setTimeout(_showLoadMessage,1500)};_showLoadMessage=function(){var _bc=top?top.bc:bc;if(loads>0&&!inProgress){inProgress=true;notification=_bc.component.notify({uid:"id"+to,className:"bd-modal-progress",icon:"loading",message:MSG_PROCESSING,delay:-1})}};hideLoadMessage=function(){if(inProgress&&loads===1){clearTimeout(to);setTimeout(function(){if(loads<1&&inProgress){notification.hide();inProgress=false}},30)}loads-=1};isIgnoredCall=function(params){return params.url.indexOf("ping.jsp")>0||params.url.indexOf(".html")>0};var cookie=function(name,value,params){var nameEncoded=encodeURIComponent(name);return jQuery.cookie(nameEncoded,value,params)};var setCookie=function(obj){obj=obj||{};jQuery.each(obj,function(name,val){document.cookie=name+"="+val})};var getCookie=function(name){var i,node,nodeArray,cookieArray,cookieMap={};if(document.cookie){cookieArray=document.cookie.split(";");for(i=0,node;node=$.trim(cookieArray[i]);i++){nodeArray=node.split("=");cookieMap[nodeArray[0]]=nodeArray[1]}return cookieMap[name]}};var getXSRFCookieName=function(){return XSRF_COOKIE};var getXSRFRequestHeaderName=function(){return XSRF_REQUEST_HEADER};var getXSRFCookie=function(){return getCookie(getXSRFCookieName())};var isMethodUnsafe=function(requestMethod){var method=typeof requestMethod==="string"?requestMethod.toUpperCase():null;return method==="POST"||method==="PUT"||method==="PATCH"||method==="DELETE"};var setXSRFHeader=function(jQueryAjaxSettings){if(isMethodUnsafe(jQueryAjaxSettings.type)){var headerName=getXSRFRequestHeaderName();var token=getXSRFCookie();if(token){jQueryAjaxSettings.headers=jQueryAjaxSettings.headers||{};jQueryAjaxSettings.headers[headerName]=token}}return jQueryAjaxSettings};var appendXSRFTagTo=function(el){var name=getXSRFCookieName();var token=getXSRFCookie();if(token){$('<input type="hidden" name="'+name+'" />').val(token).appendTo(el)}return el};ajax=function(params){var cancelMessage=isIgnoredCall(params),handledData;if(!cancelMessage){showLoadMessage()}if(params.trace){console.log("ajax:",params)}if(params.htmlDecode||params.dataType==null){params.dataType="text"}if(params.async==null){params.async=true}if(params.contentType==null){params.contentType="text/xml"}if(params.processData==null){params.processData=false}if(!params.skipTimeout&&!params.timeout){params.timeout=DEFAULT_AJAX_TIMEOUT}params.successHolder=params.success;if(params.encodeURI!==false){params.url=encodeURI(params.url)}params.success=function(data,textStatus,xhr){var contentType=xhr.getResponseHeader("Content-Type"),successHolder=this.successHolder;if(!cancelMessage){hideLoadMessage()}handledData=data;if(params.htmlDecode){handledData=HTMLDecode(data);try{handledData=$.parseXML(handledData)}catch(e){}}if(contentType&&contentType.indexOf("text/html")!==-1&&xhr.responseText.indexOf("j_spring_security_check")!==-1){be.utils.sessionExpireErrorHandler()}else{tryCatch(function(){if($.isFunction(successHolder)){successHolder(handledData,textStatus,xhr)}},function(exception){console.log("be.utils.ajax > error: "+exception)},bd.devMode)}};params.errorHolder=params.error;params.error=function(xhr,textStatus,errorThrown){var txt,defaultErrorHandler;if(!cancelMessage){hideLoadMessage()}handledData=xhr;if(!window.top.bd.isPageIframeUnloaded){if(params.htmlDecode){handledData=HTMLDecode(xhr.responseText)}if(xhr.status===0&&xhr.readyState===0&&textStatus!=="timeout"){clearTimeout(ajax.to);ajax.to=setTimeout(function(){be.utils.connectionErrorHandler()},10)}if(textStatus==="timeout"&&errorThrown==="timeout"){xhr.abortedByClient=true;bc.component.notify({uid:"timeout",className:"bd-modal-progress",icon:"loading",message:MSG_TIMEOUT,delay:5000});return false}if(params.errorHolder){txt=be.utils.getErrorText(xhr,true);params.errorHolder(handledData,txt,errorThrown)}else{defaultErrorHandler=top?top.be.utils.ajaxErrorHandler:be.utils.ajaxErrorHandler;if(defaultErrorHandler){defaultErrorHandler(xhr,textStatus,errorThrown,this.url)}else{console.log("uncaught error, xhr:",{text:xhr.responseText,status:xhr.status+": "+xhr.statusText},"status:",textStatus,"error:",errorThrown)}}}};if(be.invalidateEverything===true){params.cache=false}setXSRFHeader(params);return jQuery.ajax(params).then(function(){return handledData})};processHTMLTemplateByUrl=function(url,templateData,callback){return processTemplate(null,url,templateData,null,callback)};processHTMLTemplate=function(templateName,templateData,callback){return processTemplate(templateName,null,templateData,"html",callback)};processXMLTemplate=function(templateName,templateData,callback){var xmlContent=processTemplate(templateName,null,templateData,"xml",callback);return xmlContent};processXMLTemplateByUrl=function(url,templateData,callback){return processTemplate(null,url,templateData,null,callback)};processTemplate=function(templateName,templateUrl,templateData,templateType,callback){var templateNameCache,saveContent,templateContent,onData,render,async=callback?true:false;if(cache==null){cache={}}saveContent=function(){$.data(document.body,templateNameCache,templateContent);cache[templateNameCache]=true};onData=function(data){templateContent=data;saveContent();callback(render())};render=function(){var renderObject=Mustache.to_html($.data(document.body,templateNameCache),templateData);return renderObject};if(templateUrl==null){templateNameCache=templateName+"-"+templateType}else{templateNameCache=templateUrl}if(cache[templateNameCache]==null){if(templateUrl==null){templateContent=loadTemplate(templateName,templateType,async)}else{templateContent=loadTemplateByUrl(templateUrl,async)}if(async){templateContent.done(onData)}else{saveContent()}}if(!async){return render()}if(cache[templateNameCache]){callback(render())}};removeNonAlphaNumericChars=function(inputString){return inputString.replace(/[^a-zA-Z0-9]+/g,"")};trimString=function(inputString){try{if(inputString){return inputString.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return""}catch(e){console.log(e)}};replaceRefuzingChars=function(inputString,type){var refuzingChars;if(type==="name"){refuzingChars=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|=|\[|\]|\{|\}|;|:|,|\.|\/|\\|<|>|\?/g}else{if(type==="title"){refuzingChars=/@|<|>|\?/g}else{refuzingChars=/@|&|<|>|\?/g}}inputString=inputString.replace(refuzingChars,"");return inputString};formatAllowedName=function(inputString){inputString=trimString(inputString).replace(/(\s)+/g,"-");return replaceRefuzingChars(inputString,"name").toLowerCase()};formatAllowedFriendlyUrl=function(inputString){var refuzingChars=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|=|\[|\]|\{|\}|;|:|,|\\|<|>|\?/g;inputString=trimString(inputString).replace(/(\s)+/g,"-");inputString=inputString.replace(/(\/)+/g,"/");inputString=inputString.replace(/(^\/)+/g,"");inputString=inputString.replace(refuzingChars,"");return inputString};formatAllowedPath=function(inputString){inputString=trimString(inputString).replace(/(\s)+/g,"-");return replaceRefuzingChars(inputString,"path")};formatAllowedTitle=function(inputString){return replaceRefuzingChars(inputString,"title")};xmlEscape=function(text){text=text.replace(/&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=text.replace(/\'/g,"&#39;");text=text.replace(/\"/g,"&quot;");return text};replacePlaceHolders=function(inputString,arrayOfValues){var i,params={};for(i=0;arrayOfValues!=null&&i<arrayOfValues.length;i++){params[String(i)]=arrayOfValues[i]}return replaceParams(inputString,params)};replaceParams=function(inputString,paramsMap){var openBracket,closeBracket,currentParam,currentParamValue,output;if(inputString==null||typeof inputString==="object"){return""}openBracket=inputString.indexOf("$(");if(openBracket!==-1){closeBracket=inputString.indexOf(")");if(closeBracket===-1){return inputString}currentParam=inputString.substring(openBracket+2,closeBracket);currentParamValue=paramsMap[currentParam];if(typeof currentParamValue==="undefined"){currentParamValue="jQuery("+currentParam+")"}output=inputString.substring(0,openBracket)+currentParamValue+replaceParams(inputString.substring(closeBracket+1),paramsMap);return output}return inputString};xpathSingleNode=function(aNode,xpathExpress){var result=xpathNodes(aNode,xpathExpress);if(result[0]!=null){return result[0].nodeValue}return null};xpathSetSingleNodeValue=function(aNode,xpathExpress,value){var result=xpathNodes(aNode,xpathExpress);if(result[0]!=null){result[0].nodeValue=value}else{throw new Error("Unable to find node for: "+xpathExpress)}};xpathNodes=function(aNode,xpathExpress){var results=[],str,doc,temp,temp2,rootElement,nsResolver,nodes,currentNode;if($.browser.msie||!document.createNSResolver){if(typeof aNode.selectNodes==="undefined"){str=xml2text(aNode);doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(str);aNode=doc}if(aNode){temp=aNode.selectNodes(xpathExpress);temp2=null;while(temp2=temp.nextNode()){results.push(temp2)}}}else{rootElement=aNode.ownerDocument==null?aNode.documentElement:aNode.ownerDocument.documentElement;nsResolver=document.createNSResolver(rootElement);nodes=rootElement.ownerDocument.evaluate(xpathExpress,aNode,nsResolver,XPathResult.ANY_TYPE,null);currentNode=nodes.iterateNext();while(currentNode){results.push(currentNode);currentNode=nodes.iterateNext()}}return results};xml2text=function(xmlDoc,printPretty){var str=null,serializer;if(window.ActiveXObject){str=isString(xmlDoc)?xmlDoc:xmlDoc.xml?xmlDoc.xml:(new XMLSerializer()).serializeToString(xmlDoc)}else{serializer=new XMLSerializer();str=serializer.serializeToString(xmlDoc);if(printPretty){return XML(str).toXMLString()}}if(isDebugging("xml")){console.log("XML string: "+str)}return str};removeSelectedOption=function(selectObjeDomId){jQuery("#"+selectObjeDomId+" option:selected").remove()};getSelectionValue=function(selectObjeDomId){var elSel=document.getElementById(selectObjeDomId),elOptOld=elSel.options[elSel.selectedIndex];return elOptOld.value};resetFormValues=function(oForm){jQuery("[name]",oForm).each(function(){switch(this.getAttribute("type")){case"textarea":this.innerHTML=this.defaultValue||"";break;case"checkbox":this.checked=this.defaultChecked||false;break;default:this.value=this.defaultValue||""}})};insertOption=function(selectObjeDomId,name,value){var elSel=document.getElementById(selectObjeDomId),elOptNew,elOptOld;if(elSel.selectedIndex>=0){elOptNew=document.createElement("option");elOptNew.text=name;elOptNew.value=value;elOptOld=elSel.options[elSel.selectedIndex];try{elSel.add(elOptNew,elOptOld)}catch(ex){elSel.add(elOptNew,elSel.selectedIndex)}}else{elSel.options[elSel.options.length]=new Option(name,value);elSel.selectedIndex=0}};alert=function(params){var defaultParams={title:"Attention",message:"!",okBtnText:"Continue",closeIcon:false,respondToEscKey:false},htmlContent,dialogRef;params=$.extend(defaultParams,params||{});htmlContent=jQuery('<div class="bd-confirmationMsg"><div class="bd-confirmationInner"><h2>'+params.title+"</h2><p>"+params.message+'</p><div class="bd-buttons">  <button href="javascript:" class="bd-button bd-gradient-grey bd-roundcorner-8 bd-ok">'+params.okBtnText+"</button></div></div></div>");be.closeCurrentDialog();dialogRef=be.openDialog({htmlContent:htmlContent.get(0),closeIcon:params.closeIcon,standAlone:true,respondToEscKey:params.respondToEscKey,callback:function(){htmlContent.find(".bd-ok").focus()},small:true});htmlContent.find(".bd-ok").click(function(e){e.preventDefault();be.closeCurrentDialog();if(params.yesCallback&&typeof params.yesCallback==="function"){params.yesCallback()}});return dialogRef};confirm=function(params){var $confirmWrapper=null,defaultParams={title:"Please confirm the action",message:'Press "Remove" button if you agree',cancelBtnText:"Cancel",okBtnText:"Remove",closeIcon:true,respondToEscKey:true},htmlContent,dialogRef;params=$.extend(defaultParams,params||{});htmlContent=jQuery('<div class="bd-confirmationMsg">  <div class="bd-confirmationInner">    <h2>'+params.title+"</h2>    <p>"+params.message+'</p>    <div class="bd-buttons">      <button class="bd-button bd-roundcorner-3 bd-ok">'+params.okBtnText+'</button>      <button class="bd-button bd-roundcorner-8 bd-cancel">'+params.cancelBtnText+"</button>    </div>  </div></div>");if(params.showTextBox){jQuery(".bd-buttons",htmlContent).before('<textarea rows="" cols="" name="bdTextBox" id="bdTextBox" class="bd-text-box" />')}if(params.htmlContent){jQuery(".bd-buttons",htmlContent).before(params.htmlContent)}if(params.secondaryBtnText){jQuery(".bd-ok",htmlContent).after('<button class="bd-button bd-roundcorner-3 bd-secondaryBtn">'+params.secondaryBtnText+"</button>");htmlContent.find(".bd-secondaryBtn").click(function(e){e.preventDefault();be.closeCurrentDialog();if(params.secondaryCallback&&typeof params.secondaryCallback==="function"){params.secondaryCallback($confirmWrapper)}})}dialogRef=be.openDialog({htmlContent:htmlContent.get(0),closeIcon:params.closeIcon,respondToEscKey:params.respondToEscKey,standAlone:true,callback:function($wrapper){htmlContent.find(".bd-ok").focus();$confirmWrapper=$wrapper},closeCallback:params.noCallback,small:true,cssClass:params.cssClass});htmlContent.find(".bd-ok").click(function(e){e.preventDefault();be.closeCurrentDialog();if(params.yesCallback&&typeof params.yesCallback==="function"){params.yesCallback($confirmWrapper)}});htmlContent.find(".bd-cancel").click(function(e){e.preventDefault();be.closeCurrentDialog();if(params.noCallback&&typeof params.noCallback==="function"){params.noCallback($confirmWrapper)}});$confirmWrapper.click(function(e){e.stopPropagation()});return dialogRef};cssClass=function(){};loadCSSByUrl=function(path){if(!jQuery("link[href='"+contextRoot+path+"']").length){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("type","text/css");link.setAttribute("href",contextRoot+path);document.getElementsByTagName("head")[0].appendChild(link)}};unique=function(arr){return $.grep(arr,function(v,k){return $.inArray(v,arr)===k})};delay=(function(){var timer=0;return function(callback,ms){clearTimeout(timer);timer=setTimeout(callback,ms)}}());CustomMethodForValidator={validTitle:function(){jQuery.validator.addMethod("validTitle",function(value){var regex=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|=|\[|\]|\{|\}|;|:|,|\/|\\|<|>|\?/g;return value.match(regex)==null},"Title cannot contain special characters")},validUserName:function(){jQuery.validator.addMethod("validUserName",function(value){var regex=/~|!|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|=|\[|\]|\{|\}|;|:|,|\/|\\|<|>|\?/g;return value.match(regex)==null},"Name cannot contain special characters")},samePortalPageName:function(params){jQuery.validator.addMethod("samePortalPageName",function(value){return value.toLowerCase()!==params.portalName.toLowerCase()},"Item can not have the same name as the portal")},specialPageUrlSpecialChar:function(){jQuery.validator.addMethod("specialPageUrlSpecialChar",function(value){var regex=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|\[|\]|\{|\}|;|:|,|\\|<|>/g;value=value.replace(/^(https?|ftp):\/\//,"");return value.match(regex)==null},"URL can not contain any special characters")},defaultLandingPageUrlSpecialChar:function(){jQuery.validator.addMethod("defaultLandingPageUrlSpecialChar",function(value){var regex=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|\[|\]|\{|\}|;|,|<|>/g;return value.match(regex)==null},"URL can not contain any special characters")},friendlyUrlSpecialChar:function(){jQuery.validator.addMethod("friendlyUrlSpecialChar",function(value){var regex=/~|!|@|#|\$|%|\^|&|\*|\(|\)|\+|`|'|"|\[|\]|\{|\}|;|:|,|\\|<|>|\?|=|\s/g;return value.match(regex)==null},"URL can not contain any special characters")}};addCustomMethodToValidator=function(methodNameArray,params){var i,arrayLen;if(methodNameArray){for(i=0,arrayLen=methodNameArray.length;i<arrayLen;i++){if(typeof(CustomMethodForValidator[methodNameArray[i]])==="function"){CustomMethodForValidator[methodNameArray[i]](params)}}}};ISODateString=function(d){function pad(n){return(n<10?"0"+n:n)}return d.getUTCFullYear()+"-"+pad(d.getUTCMonth()+1)+"-"+pad(d.getUTCDate())+"T"+pad(d.getUTCHours())+":"+pad(d.getUTCMinutes())+":"+pad(d.getUTCSeconds())+"Z"};fromISO=function(d){var diso=Date.parse("2011-04-26T13:16:50Z"),day,tz,rx,p;if(diso===1303823810000){return new Date(Date.parse(d))}rx=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/;p=rx.exec(d)||[];if(p[1]){day=p[1].split(/\D/).map(function(itm){return parseInt(itm,10)||0});day[1]-=1;day=new Date(Date.UTC.apply(Date,day));if(!day.getDate()){return NaN}if(p[5]){tz=parseInt(p[5],10)*60;if(p[6]){tz+=parseInt(p[6],10)}if(p[4]==="+"){tz*=-1}if(tz){day.setUTCMinutes(day.getUTCMinutes()+tz)}}return day}return NaN};truncateText=function(str,requiredLength,appendix){var visibleLength;appendix=appendix||"...";visibleLength=requiredLength-appendix.length;if(visibleLength<0){return str.substr(0,requiredLength)}return(str.length>requiredLength)?str.substr(0,visibleLength)+appendix:str};bytesToSize=function(bytes){var i,sizes=["n/a","bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];if(isNaN(bytes)){return sizes[0]}i=+Math.floor(Math.log(bytes)/Math.log(1024));return(bytes/Math.pow(1024,i)).toFixed(i?1:0)+" "+sizes[isNaN(bytes)?0:i+1]};mergeJsonObj=function(obj1,obj2){var p;for(p in obj2){try{if(obj1[p]&&obj2[p]&&obj2[p].constructor===Object){obj1[p]=mergeJsonObj(obj1[p],obj2[p])}else{obj1[p]=obj2[p]}}catch(e){obj1[p]=obj2[p]}}return obj1};var mergeArrays=function(arr1,arr2){return arr1.concat(arr2.filter(function(item){return arr1.indexOf(item)<0}))};getWindowSize=function(){var size={width:0,height:0};if(typeof(window.innerWidth)==="number"){size.width=window.innerWidth;size.height=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){size.width=document.documentElement.clientWidth;size.height=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){size.width=document.body.clientWidth;size.height=document.body.clientHeight}}}return size};varicalPagination=function(params){var ul=jQuery("ul",jQuery(params.container)),heightPerPage=jQuery(params.container).outerHeight(true),clickFlag=false,scrolling=false;jQuery(params.upButton).click(function(){var top=parseInt(ul.css("top"),10)-heightPerPage;if(top>-(ul.outerHeight(true))&&!clickFlag){clickFlag=true;ul.stop().animate({top:top},"slow",function(){clickFlag=false})}});jQuery(params.downButton).click(function(){var top=parseInt(ul.css("top"),10)+heightPerPage;if(top<=0&&!clickFlag){clickFlag=true;ul.stop().animate({top:top},"slow",function(){clickFlag=false})}});jQuery(params.container).on("mousewheel DOMMouseScroll",function(event){var delta=event.originalEvent.wheelDelta||-event.originalEvent.detail;event.preventDefault();event.stopPropagation();if(!scrolling){this.scrolling=true;if(delta<0){jQuery(params.upButton).trigger("click")}else{if(delta>0){jQuery(params.downButton).trigger("click")}}setTimeout(function(){scrolling=false},500)}})};log=function(message,resource,option){var optionType,messageType,formattedMessage,logItem,target;if(be.devMode&&resource&&message){optionType=$.type(option);if(optionType==="boolean"&&option){console.dir(message);return}messageType=$.type(message);if(messageType==="object"||messageType==="array"){console.log(message)}if(messageType==="string"){formattedMessage="-> [";if(resource){formattedMessage+=resource+": "}formattedMessage+=message+"]";if(optionType==="undefined"){console.log(formattedMessage);return}if(optionType==="string"){logItem=jQuery('<div class="bd-devmode-log-item">'+formattedMessage+"</div>");target=jQuery("#"+option);if(target){logItem.appendTo(target)}return}}}};serializeJSON=function(form){var json={},formArray=[];formArray=jQuery(form).serializeArray();jQuery(form).find('input[type="checkbox"]').each(function(){formArray.push({name:this.name,value:this.checked?"yes":"no"})});jQuery.map(formArray,function(value){json[value.name]=value.value});return json};convertToArray=function(oInput){if(!oInput){return[]}if(typeof oInput==="string"||!oInput.length){oInput=[oInput]}return oInput};getNodeText=function(nodeName,xml){return trimString(jQuery(xml.find(nodeName)[0]).text())};digitString=function(nr,nrOfDigits){var n,ret,i;n=nr.toString();ret="";for(i=0;i<nrOfDigits-n.length;i++){ret+="0"}return ret+n};isString=function(obj){return(typeof obj==="string"||obj instanceof String)};stripHTML=function(str){str=jQuery.trim(jQuery("<div>"+str+"</div>").text());str=str.replace(/&[^;]*;/g,"xx");str=str.replace(/[<>()'"&]/g,"-");return str};function HTMLEncode(value){return $("<div/>").text(value).html()}var isEncoded=function(responseText){var LESS_THAN_HEX_CODE="&#x3c;",LESS_THAN_DECIMAL_CODE="&#60;",LEFT_CURLY_BRACKET_HEX_CODE="&#x7b;",LEFT_CURLY_BRACKET_DECIMAL_CODE="&#123;";return(responseText.indexOf(LESS_THAN_HEX_CODE)!==-1)||(responseText.indexOf(LEFT_CURLY_BRACKET_HEX_CODE)!==-1)||(responseText.indexOf(LESS_THAN_DECIMAL_CODE)!==-1)||(responseText.indexOf(LEFT_CURLY_BRACKET_DECIMAL_CODE)!==-1)};function HTMLDecode(value){if(!isEncoded(value)){return value}return $("<div/>").html(value).text()}isInteger=function(param){var regex=/^\d+$/g;return regex.test(param)};formatDate=function(timestamp){var p=timestamp.match(/\d+/g),d,hour,min,date,month,amPm;if(p.length>7){d=new Date(p[0],p[1],p[2],p[3],p[4],p[5]);hour=d.getHours();min=d.getMinutes();date=d.getDate();month=d.getMonth();amPm="AM";if(hour>11){amPm="PM"}if(hour>12){hour=hour-12}if(hour===0){hour=12}min=(min<10)?"0"+min:min;date=(date<10)?"0"+date:date;month=(month<10)?"0"+month:month;return month+"/"+date+"/"+d.getFullYear()+" "+hour+":"+min+" "+amPm}return timestamp};daysInMonth=function(month,year){return new Date(year,month,0).getDate()};getTagContents=function(str,tagName){var pos2,pos1=str.indexOf("<"+tagName+">");if(pos1>-1){pos2=str.indexOf("</"+tagName+">");return str.substring(pos1+tagName.length+2,pos2)}return""};getCursor=function(pElem){var selection,range,parentNode=null,rangeObj={},isIE8=window.getSelection?false:true;rangeObj.replace=function(node){if(!node){return}if(isIE8){document.selection.clear();range.pasteHTML(node.outerHTML)}else{range.deleteContents();range.insertNode(node)}};rangeObj.append=function(node){if(!node){return}if(isIE8){try{range.pasteHTML(node.innerHTML);range.collapse(false);range.select()}catch(e){}}else{range.deleteContents();node=nodesWrapper(node.innerHTML);range.insertNode(node.fragment);if(node.lastNode){range=range.cloneRange();range.setStartAfter(node.lastNode);range.collapse(true);selection=window.getSelection();selection.removeAllRanges();selection.addRange(range)}}};rangeObj.hasSelected=function(){if(isIE8){if(range.length){return true}if(range.htmlText!==""){return true}return false}return range.endOffset===range.startOffset?false:true};rangeObj.getSelected=function(){if(rangeObj.hasSelected()){if(isIE8){return range.text}return range.toString()}return false};rangeObj.hasCursor=function(node){if(parentNode){var elm=node||pElem;return(jQuery(elm).has(parentNode).length>0)}return false};rangeObj.getStartElement=function(){var startElement=null;if(range.startContainer){if(range.startContainer.nodeName==="#text"){startElement=range.startContainer.parentNode}else{startElement=range.startContainer}}else{if(range.parentElement()){startElement=range.parentElement()}}return startElement};if(window.getSelection){try{range=window.getSelection().getRangeAt(0)}catch(e){}}else{if(document.selection&&document.selection.createRange){range=document.selection.createRange();if(window.savedRange&&(jQuery.contains(pElem,window.savedRange.parentElement())||pElem===window.savedRange.parentElement())){range=window.savedRange;range.select()}}}try{parentNode=range.startContainer?range.startContainer.parentNode:range.parentElement()}catch(e){}rangeObj.range=range;rangeObj.parentNode=parentNode;rangeObj.node=pElem;return rangeObj};nodesWrapper=function(html){var el=document.createElement("div"),frag=document.createDocumentFragment(),node,lastNode;el.innerHTML=html;while((node=el.firstChild)){lastNode=frag.appendChild(node)}return{lastNode:lastNode,fragment:frag}};clickOutside=function(data){var area=data.area,doc=jQuery((area&&area.length&&area[0].ownerDocument)||document),ns=data.ns?"."+data.ns:".outside",clickOutsideHandler,keyHandler;clickOutsideHandler=function(e){var ignore,ignoreList,i,length,el;if(e.data.area&&e.data.area.length){if(!e.data.area.is(e.target)&&e.data.area.has(e.target).length===0){ignore=!(jQuery.contains(doc.find("body")[0],e.target));if(!ignore&&data.ignore){ignoreList=data.ignore.length?data.ignore:[data.ignore];length=ignoreList.length;el=jQuery(e.target);for(i=0;i<ignoreList.length;i++){if(el.is(ignoreList[i]).length||el.parents(ignoreList[i]).length){ignore=true;break}}}if(!ignore&&$.isFunction(e.data.outside)){e.data.outside(e.data);if(data.reset){doc.unbind(ns)}}}}};keyHandler=function(e){if(e.keyCode===27&&jQuery.isFunction(e.data.escape)){e.data.escape(e.data);if(data.reset){doc.unbind(ns)}}if(e.keyCode===13&&jQuery.isFunction(e.data.enter)){e.data.enter(e.data);if(data.reset){doc.unbind(ns)}}};doc.unbind(ns);if(data.outside&&jQuery.isFunction(data.outside)){doc.bind("click"+ns,data,clickOutsideHandler)}if(data.enter||data.escape){doc.bind("keydown"+ns,data,keyHandler)}};resetOutside=function(ns){jQuery(document).unbind(ns?"."+ns:".outside")};isDebugging=function(what){var loc=location.href.toLowerCase();return(bd.devMode&&loc.indexOf("debugmode=true")>10&&loc.indexOf("test="+what)>10)};testDelay=function(totalCalls,maxTimeClient,maxTimeServer){var calls=0,done=0,actualTime,onFinished,delayedCall;totalCalls=totalCalls||Math.ceil(Math.random()*30);maxTimeClient=maxTimeClient||Math.ceil(Math.random()*10000);maxTimeServer=maxTimeServer||Math.ceil(Math.random()*10000);actualTime=function(startTime){return new Date().getTime()-startTime};onFinished=function(isOK,delay,startTime){var at=actualTime(startTime);console.log((totalCalls-(++done))+") delay: "+delay+", time: "+at+", diff :"+(at-delay))};delayedCall=function(){if(calls++<totalCalls){setTimeout(function(){makeDelayedCall(Math.round(Math.random()*maxTimeClient),onFinished)},Math.round(Math.random()*maxTimeServer));delayedCall()}};delayedCall()};makeDelayedCall=function(delay,onFinished){var startTime=new Date().getTime(),url=contextRoot+"/static/testjsp/delay.jsp?delay="+delay,onSuccess,onError;onFinished=onFinished||function(ok){console.log("call completed",ok?"succesfully":"with errors")};onSuccess=function(){onFinished(true,delay,startTime)};onError=function(){onFinished(false,delay,startTime)};be.utils.ajax({url:url,processData:true,dataType:"xml",cache:false,async:true,success:onSuccess,error:onError,type:"GET"})};if(isDebugging("delay")){mattsTest=function(){console.log("running matt's test");setTimeout(testDelay,1000)};ericsTest=function(){console.log("running eric's test");setTimeout(function(){makeDelayedCall(1000,function(){makeDelayedCall(7000,function(){console.log("done 2")});console.log("done 1")})},3000)};(Math.random()>0.5)?ericsTest():mattsTest()}notifier=function(url,requestMethod){this.requestMethod=requestMethod||"GET";this.stages=[1000,5000,10000];this.stageChange=10;this.poller=null;this.subscribers={};this.errorHandlers={};this.lastId=0;this.totalSubscribers=0;this.url=url};notifier.prototype.subscribe=function(callback,errorHandler,postData){var errorCount=0,maxErrors=3,self=this,paused=false,url,idx;if(this.currentStage!==0&&this.poller){clearInterval(this.poller);this.poller=null}this.currentStage=0;this.stageCount=0;idx=this.lastId++;this.totalSubscribers++;this.subscribers[idx]=callback;this.errorHandlers[idx]=errorHandler;this.pause=function(){paused=true};this.resume=function(){paused=false};this.doUpdate=function(){if(paused){return}self.pause();if(self.lastUpdate){url=self.url.replace("{{lastUpdate}}",self.lastUpdate)}else{url=self.url.replace("{{lastUpdate}}","")}ajax({url:url,data:postData||null,processData:postData?true:false,dataType:self.requestMethod==="PUT"?"json":"xml",cache:false,async:true,success:function(data){var i;errorCount=0;self.stageCount++;for(i=0;i<self.lastId;i++){try{if(self.subscribers[i]){self.subscribers[i](data)}else{self.unsubscribe(i)}}catch(e){self.unsubscribe(i)}}if(self.stageCount>=self.stageChange&&self.currentStage<self.stages.length-1){self.stageCount=0;self.currentStage++;clearInterval(self.poller);self.poller=setInterval(self.doUpdate,self.stages[self.currentStage])}self.resume()},error:function(jqXHR,textStatus){var i;self.pause();if(++errorCount>=maxErrors){clearInterval(self.poller)}console.log(textStatus);for(i=0;i<self.lastId;i++){if(self.errorHandlers[i]){self.errorHandlers[i](jqXHR)}}},type:self.requestMethod})};if(!this.poller&&this.url){this.poller=setInterval(this.doUpdate,this.stages[0])}return idx};notifier.prototype.unsubscribe=function(idx){if(idx!==undefined){if(this.subscribers[idx]){delete this.subscribers[idx];delete this.errorHandlers[idx];this.totalSubscribers--}}else{this.subscribers=[];this.errorHandlers=[];this.totalSubscribers=0}if(this.totalSubscribers===0){this.lastUpdate=null;clearInterval(this.poller);this.poller=null}};calcImageSize=function(imgWidth,imgHeight,targetWidth,targetHeight){var defaultW=targetWidth||100,defaultH=targetHeight||100,calcWidth=Math.floor(imgWidth*(defaultH/imgHeight)),calcHeight=Math.floor(imgHeight*(defaultW/imgWidth)),style={};if(isNaN(imgWidth)||isNaN(imgHeight)||isNaN(defaultW)||isNaN(defaultH)||imgWidth<0||imgHeight<0||defaultW<0||defaultH<0){return false}if(imgWidth>=defaultW){if(calcHeight<=defaultH){style.width=defaultW;style.height=calcHeight}else{style.width=calcWidth;style.height=defaultH}}else{if(imgHeight>=defaultH){if(calcWidth<=defaultW){style.width=calcWidth;style.height=defaultH}else{style.width=defaultW;style.height=calcHeight}}else{style.width=imgWidth;style.height=imgHeight}}style.marginLeft=-1*(style.width/2);style.marginTop=-1*(style.height/2);return style};tryCatch=function(tryFn,errorFn,skipTry){if(skipTry||true||(location.search&&location.search.indexOf("debug=true")>-1)){if($.isFunction(tryFn)){tryFn()}}else{try{if($.isFunction(tryFn)){tryFn()}}catch(e){if($.isFunction(errorFn)){errorFn(e)}}}};autoScroll=(function(This){var doc=jQuery(document),started=false,animate=function(){var el,i,l=This.areas&&This.areas.length||0,n=15;for(i=0;i<l;i++){el=This.areas[i];el.scrollTop=el.scrollTop-n*(el.speed||0)}This.scrollTimeout=window.setTimeout(animate,20)},move=function(e,aRes){var pageY=e.pageY,el,delta,i,l=aRes&&aRes.length||0,h,speed,oCoord;This.areas=aRes;for(i=0;i<l;i++){speed=0;el=This.areas[i];oCoord=getBoxObject(el);h=oCoord.h/4;delta=(This.pageY||pageY)-pageY;This.pageY=pageY;This.sum=(This.sum||0)+delta;if((pageY<oCoord.y+h)&&This.sum>20&&h>0){speed=(oCoord.y-pageY)/h+1}if((pageY>oCoord.y+3*h)&&This.sum<-20&&h>0){speed=(oCoord.y+3*h-pageY)/h}el.speed=Math.abs(speed)>1?0:speed}if(!started){started=true;animate()}},start=function(scrollArea){doc.bind("mouseup.be_autoscroll",stop);doc.bind("mousemove.be_autoscroll",function(e){move(e,scrollArea)})},stop=function(){This.sum=0;This.pageY=false;started=false;window.clearTimeout(This.scrollTimeout);doc.unbind(".be_autoscroll")};return{move:move,start:start,stop:stop}}(window));getBoxObject=function(elm){var r=jQuery(elm).offset(),c={x:r.left,y:r.top,left:r.left,top:r.top,w:elm.offsetWidth,h:elm.offsetHeight};return c};isBrowserDetected=false;browserDetection=function(isForceStart){var flag=isForceStart===true?true:!isBrowserDetected,engine=null,isIE6="",className="",plusMinus;if(!flag){return""}isBrowserDetected=true;plusMinus=function(version,engine){var str=" ie"+version;return(str+(engine>=version?(engine==version?"plus"+str+"minus":"plus"):"minus"))};if(window.navigator.appName=="Microsoft Internet Explorer"){if(document.documentMode){engine=document.documentMode}else{engine=5;if(document.compatMode){if(document.compatMode=="CSS1Compat"){if(jQuery.browser.version.substr(0,1)<7){isIE6=" ie-6"}engine=7}}}className=" ie ie"+engine+isIE6+plusMinus(7,engine)+plusMinus(8,engine)+plusMinus(9,engine)+plusMinus(10,engine)}else{if(jQuery.browser.webkit){className=" webkit"}else{if(jQuery.browser.opera){className=" opera"}else{if(jQuery.browser.mozilla){className=" mozilla"}}}}return className};module=function(moduleName){var modulePath,tmpModule,i,l,c;if(!moduleName){return null}if(!window){window={}}modulePath=moduleName.split(".");tmpModule=window;for(i=0,l=modulePath.length;i<l;i++){c=modulePath[i];if(!tmpModule[c]){tmpModule[c]={}}tmpModule=tmpModule[c]}return tmpModule};define=function(name,deps,factory){var global=window,namespaces,depsRef=[],method,ns,obj;if(typeof name!=="string"){factory=deps;deps=name;name=null}if(deps instanceof Array===false){factory=deps;deps=null}if(typeof define==="function"&&define.amd){define([name],deps,factory)}else{if(typeof exports==="object"){module.exports=factory(require(name))}else{method=name.split(".").pop();ns=name.split(".").slice(0,-1).join(".");obj=module(ns)||{};if(deps){jQuery.each(deps,function(i,d){depsRef[i]=module(d)})}obj[method]=jQuery.extend({},obj[method],factory.apply(null,depsRef))}}};getQueryStringParam=function(name){var queryStr=location.search,queryStrArray,result=false,i,c;if(!queryStr){return result}queryStr=queryStr.replace(location.hash,"");queryStr=queryStr.replace("?","");result={};queryStrArray=queryStr.split("&");for(i=queryStrArray.length-1;i>=0;i--){c=queryStrArray[i].split("=");result[c[0]]=decodeURIComponent(c[1].replace(/\+/g," "))}if(name){result=result[name];if(result!==undefined||result!==null){return result}else{return false}}else{return result}};getErrorText=function(xhr,htmlDecode){var txt;if(xhr&&xhr.responseText){var response=xhr.responseText;if(htmlDecode){response=HTMLDecode(response)}txt=be.utils.getTagContents(response,"message");if(!(txt&&txt.length>0)){txt=be.utils.getTagContents(response,"title")}if(!(txt&&txt.length>0)){txt=response;try{var descr=$(txt).find(".bd-errorDescription");if(descr.length){txt=$.trim(descr.text())}}catch(e){}}}return HTMLEncode(txt)};padDigits=function(number,digits){digits=digits||2;return Array(Math.max(digits-String(number).length+1,0)).join(0)+number};if(!Date.prototype.adjust){Date.prototype.adjust=function(part,amount){var map,mapPart;part=part.toLowerCase();map={years:"FullYear",months:"Month",weeks:"Hours",days:"Hours",hours:"Hours",minutes:"Minutes",seconds:"Seconds",milliseconds:"Milliseconds",utcyears:"UTCFullYear",utcmonths:"UTCMonth",utchours:"UTCHours",utcdays:"UTCDays",utcminutes:"UTCMinutes",utcseconds:"UTCSeconds",utcmilliseconds:"UTCMilliseconds"};mapPart=map[part];if(part=="weeks"||part=="utcweeks"){amount*=168}if(part=="days"||part=="utcdays"){amount*=24}this["set"+mapPart](this["get"+mapPart]()+amount);return this}}if(!Date.prototype.diff){Date.prototype.diff=function(date2,parts){var i,l,k,tmpDiff,d1=new Date(this.getTime()),d2=new Date(date2.getTime()),pm=d1<=d2?1:-1,result={},factors={weeks:(1000*60*60*24*7),days:(1000*60*60*24),hours:(1000*60*60),minutes:(1000*60),seconds:1000,milliseconds:1};if(parts===undefined){parts=["years","months","weeks","days","hours","minutes","seconds","milliseconds"]}else{if(typeof(parts)=="string"){parts=[parts]}}for(i=0,l=parts.length;i<l;i++){k=parts[i];result[k]=0;if(factors[k]===undefined){inaWhile:while(true){d2.adjust(k,-1*pm);if((pm===1&&d1>d2)||(pm===-1&&d1<d2)){d2.adjust(k,1*pm);break inaWhile}result[k]++}}else{tmpDiff=Math.abs(d2.getTime()-d1.getTime());result[k]=Math.floor(tmpDiff/factors[k]);d2.adjust(k,result[k]*-1*pm)}result[k]*=pm}if(parts.length==1){return result[parts[0]]}return result}}if(!Date.prototype.each){Date.prototype.each=function(endDate,part,step,fn,bind){var fromDate=new Date(this.getTime()),toDate=new Date(endDate.getTime()),pm=fromDate<=toDate?1:-1,i=0;while((pm===1&&fromDate<=toDate)||(pm===-1&&fromDate>=toDate)){if(fn.call(bind,fromDate,i,this)===false){break}i+=step;fromDate.adjust(part,step*pm)}return this}}if(!Date.prototype.toISOString){(function(){Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+padDigits(this.getUTCMonth()+1)+"-"+padDigits(this.getUTCDate())+"T"+padDigits(this.getUTCHours())+":"+padDigits(this.getUTCMinutes())+":"+padDigits(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}())}if(!Date.prototype.toISOLocalString){(function(){Date.prototype.toISOLocalString=function(){return this.getFullYear()+"-"+padDigits((this.getMonth()+1))+"-"+padDigits(this.getDate())+"T"+padDigits(this.getHours())+":"+padDigits(this.getMinutes())+":"+padDigits(this.getSeconds())+"."+padDigits(this.getMilliseconds())+"Z"}}())}startModule=function(){var dfd=new $.Deferred(),promise=dfd.promise(),getSelectedPortalName=function(){var l=location.href,s=l.lastIndexOf("//"),e=l.indexOf("?"),n;e=e==-1?l.length:e;n=l.substring(s+2,e);n=n.length>0&&s>5&&l.length>n.length?n:"dashboard";return n},init=function(){var selectedPortalName=getSelectedPortalName(),failMsg='Sorry, No portal found with name "'+selectedPortalName+'"';bd.getPortalsModel().done(function(data){var portal=data.filter(function(portal){return(portal.portalName==selectedPortalName)})[0];if(portal){bd.selectedPortalName=portal.portalName;bd.selectedPortalTitle=portal.title;bd.selectedPortalOptimizedFor=portal.defaultDevice;bd.selectedPortalTargetDevice=portal.deviceTarget;dfd.resolve()}else{notification=bc.component.notify({uid:"noSuchPortal",icon:"error",message:failMsg,delay:-1});dfd.reject(failMsg)}})};init();return promise};function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};parseParamsToObject=function(url){return parseUri(url).queryKey};isType=function isType(item,type){return Object.prototype.toString.call(item).toLowerCase()==="[object "+type.toLowerCase()+"]"};filterItems=function filterItems(toExclude,key,value){var toExcludeKey,items,filteredItems=[];for(toExcludeKey in toExclude){if(toExclude.hasOwnProperty(toExcludeKey)){items=toExclude[toExcludeKey];if(isType(items,"array")){filteredItems=items.filter(function(item,index,array){var keys=key.split("::");var _value=item;keys.forEach(function(_key){_value=_value&&_value[_key]});return _value!==value});filterItems(filteredItems,key,value);toExclude[toExcludeKey]=filteredItems}else{if(isType(items,"object")){filterItems(items,key,value)}}}}};function watchElement(selector,data,watch,trigger){var timeout;jQuery(window).on("resize",function(){if(timeout){clearTimeout(timeout)}timeout=setTimeout(function(){var element=jQuery(selector)[0];if(element){if(watch(element,data)){trigger(data,element)}}},25)})}function checkChangesHeight(selector,trigger){var data={};this.watchElement(selector,data,function(element,data){var height=parseInt($(element).css("height"),10);var widthFirstChild=parseInt($("button:eq(0)",element).css("width"),10);data.prevWidthFirstChild=data.newWidthFirstChild||widthFirstChild;data.newWidthFirstChild=widthFirstChild;data.prevHeight=data.newHeight||height;data.newHeight=height;return data.newHeight!==data.prevHeight||data.newWidthFirstChild!==data.prevWidthFirstChild},trigger)}function formatJson(json){var result='<div style="width:800px; font-family: monospace;">{';function jsonRenderer(content,margin){for(var x in content){if(content.hasOwnProperty(x)){if(typeof content[x]==="object"){result+='<div style="margin-left:'+margin+'px">"'+x+'" : {</div>';jsonRenderer(content[x],(margin+20));result+='<div style="margin-left:'+margin+'px">}</div>'}else{result+='<div style="margin-left:'+margin+'px">"'+x+'" : "'+(content[x]+"")+'"</div>'}}}}jsonRenderer(json,20);result+="}</div>";return result}serverStatus={solr:{checkStatus:function(){var deferred=new jQuery.Deferred();ajax({url:contextRoot+"/portals/solr/status.xml",dataType:"xml",cache:false,async:true,success:function(data){if(jQuery("status",data).text()!=="OK"){deferred.reject()}else{deferred.resolve()}},error:function(){deferred.reject()},type:"GET"});return deferred.promise()}}};throttle=function(func,wait){var timeout=null,previous=0;return function(){var now=new Date().getTime(),left=wait-(now-previous),context=this;if(!previous||left<=0){if(timeout){clearTimeout(timeout);timeout=null}func.apply(this,arguments);previous=now}else{if(!timeout){timeout=setTimeout(function(){previous=new Date().getTime();func.apply(context,arguments)},left)}}}};return{getURLRoot:getURLRoot,domReady:domReady,domJsReady:domJsReady,ajax:ajax,getTemplateDataFromForm:getTemplateDataFromForm,loadTemplate:loadTemplate,loadTemplateByUrl:loadTemplateByUrl,loadCSSByUrl:loadCSSByUrl,processHTMLTemplateByUrl:processHTMLTemplateByUrl,processHTMLTemplate:processHTMLTemplate,processXMLTemplateByUrl:processXMLTemplateByUrl,processXMLTemplate:processXMLTemplate,processTemplate:processTemplate,removeNonAlphaNumericChars:removeNonAlphaNumericChars,trimString:trimString,replaceRefuzingChars:replaceRefuzingChars,formatAllowedName:formatAllowedName,formatAllowedTitle:formatAllowedTitle,formatAllowedPath:formatAllowedPath,formatAllowedFriendlyUrl:formatAllowedFriendlyUrl,xmlEscape:xmlEscape,replaceParams:replaceParams,xpathSingleNode:xpathSingleNode,xpathSetSingleNodeValue:xpathSetSingleNodeValue,xpathNodes:xpathNodes,xml2text:xml2text,varicalPagination:varicalPagination,removeSelectedOption:removeSelectedOption,getSelectionValue:getSelectionValue,resetFormValues:resetFormValues,insertOption:insertOption,alert:alert,confirm:confirm,unique:unique,delay:delay,addCustomMethodToValidator:addCustomMethodToValidator,ISODateString:ISODateString,truncateText:truncateText,bytesToSize:bytesToSize,mergeJsonObj:mergeJsonObj,mergeArrays:mergeArrays,fromISO:fromISO,getWindowSize:getWindowSize,log:log,serializeJSON:serializeJSON,cookie:cookie,setCookie:setCookie,getCookie:getCookie,convertToArray:convertToArray,digitString:digitString,formatDate:formatDate,getDateString:getDateString,getNodeText:getNodeText,clickOutside:clickOutside,resetOutside:resetOutside,stripHTML:stripHTML,HTMLEncode:HTMLEncode,HTMLDecode:HTMLDecode,getTagContents:getTagContents,isInteger:isInteger,showLoadMessage:showLoadMessage,hideLoadMessage:hideLoadMessage,getCursor:getCursor,notifier:notifier,isString:isString,isDebugging:isDebugging,calcImageSize:calcImageSize,tryCatch:tryCatch,autoScroll:autoScroll,browserDetection:browserDetection,module:module,define:define,getQueryStringParam:getQueryStringParam,getErrorText:getErrorText,startModule:startModule,parseParamsToObject:parseParamsToObject,filterExcluded:filterItems,watchElement:watchElement,checkChangesHeight:checkChangesHeight,serverStatus:serverStatus,formatJson:formatJson,getXSRFRequestHeaderName:getXSRFRequestHeaderName,getXSRFCookieName:getXSRFCookieName,getXSRFCookie:getXSRFCookie,setXSRFHeader:setXSRFHeader,appendXSRFTagTo:appendXSRFTagTo,throttle:throttle}})(window,jQuery);(function(){if(window.CSS&&window.CSS.escape){return}var a=function(h){if(arguments.length==0){throw new TypeError("`CSS.escape` requires an argument.")}var e=String(h);var g=e.length;var d=-1;var f;var b="";var c=e.charCodeAt(0);while(++d<g){f=e.charCodeAt(d);if(f==0){b+="\uFFFD";continue}if((f>=1&&f<=31)||f==127||(d==0&&f>=48&&f<=57)||(d==1&&f>=48&&f<=57&&c==45)){b+="\\"+f.toString(16)+" ";continue}if(d==0&&g==1&&f==45){b+="\\"+e.charAt(d);continue}if(f>=128||f==45||f==95||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122){b+=e.charAt(d);continue}b+="\\"+e.charAt(d)}return b};if(!window.CSS){window.CSS={}}window.CSS.escape=a})();be=be||{};be.dialogs=be.dialogs||{};be.dialogs.preventDefault=false;be.dialogContainersStack=[];be.modalsClosed=true;be.openDialog=function(e){var i,l,h,n,f,j,g,d,c,a,k,m,b;e=e||{};i=jQuery(window).scrollTop();be.utils.loadCSSByUrl("/static/backbase.com.2012.aurora/css/dialogs.css");jQuery(".dashBoardTitle").fadeOut("fast");if(e.headerCloseIcon==null){jQuery(".bd-closeIcon").show()}jQuery(".bd-page-index").fadeOut("fast");if((e.respondToEscKey==null)||(e.respondToEscKey==true)){e.respondToEscKey="true"}else{e.respondToEscKey="false"}l=e.cssClass?"bd-dialog-wrapper "+e.cssClass:"bd-dialog-wrapper";h=jQuery('<div class="'+l+'" data-respondToEscKey="'+e.respondToEscKey+'"></div>').appendTo(e.wrapper?e.wrapper:"body");n=jQuery('<div class="bd-dialog-container bd-roundcorner-10"></div>');f=(e.duration===undefined)?200:e.duration;if(e.excludeShadow==null){n.addClass("bd-shadow")}if(e.small==null){n.addClass("bd-dialog-maximizedLayout")}if(e.className!=null){h.addClass(e.className)}n.append(e.htmlContent).appendTo(h);j=jQuery(".portal-widgetHolder",n);if(j.length==0){j=n}if(e.closeIcon){jQuery('<a class="bd-dialog-closeIcon" title="Close dialog"></a>').click(function(){closeParams={};if(e.closeCallback&&typeof e.closeCallback=="function"){closeParams.closeCallback=e.closeCallback}be.closeCurrentDialog(closeParams)}).prependTo(j)}if(e.header!==undefined&&e.header!=""){j.prepend('<div class="bd-dialog-header">'+e.header+"</div>")}g={small:function(){var o=jQuery("html").attr("dir").toLowerCase(),q,v,u,r,t,p,s;windowsize=be.utils.getWindowSize();q=windowsize.width/2;v=windowsize.height/2;if(e.containerMargins){u=e.containerMargins.mLeft;r=e.containerMargins.mTop}else{u=200;r=130}t=q-u;p="auto";s=v-r;s=(s<20?20:s);var o=jQuery("body").css("direction");return{css:{opacity:0.2,top:s,left:o==="rtl"?p:t,right:o==="rtl"?t:p},open:{opacity:1,top:"+=10"},openDuration:f,openEasing:"swing",close:{opacity:0.2,top:"+=10"},closeDuration:f,closeEasing:"swing"}}};d=e.anim||g.small();if(e.small){h.addClass("bd-dialog-wrapper-small");if(e.keepMargins!==undefined){c=parseFloat(e.keepMargins);a=n.width();k=d.css.left;c=isNaN(c)?0:c;m=function(){var o=jQuery(window).width(),p=d.css.left+a-o<c?d.css.left:o-a-c;if(p<k){d.css.left=p;n.css({left:p})}else{d.css.left=k}};m()}d.css.top+=i;n.css(d.css).animate(d.open,d.openDuration,d.openEasing)}else{h.addClass("bd-dialog-wrapper-big");h.addClassAnim("bd-dialog-wrapper-open",f)}if(e.standAlone){h.addClass("standAlone");b=jQuery('<div class="bd-popupForm-cover"></div>');h.append(b)}h.data("anim",d);h.data("params",e);be.dialogContainersStack.push(h);if(e.callback){e.callback(h)}return h};be.closeCurrentDialog=function(e){be.modalsClosed=false;var a=be.dialogContainersStack;if(e&&e.closeModalsOnly&&e.closeModalsOnly===true){if(a&&a.length&&a.length>0){if(a[a.length-1].hasClass("bd-dialog-wrapper-big")){be.modalsClosed=true;return}}}jQuery(document.body).trigger("click.dropDown");if(be.dialogs.preventDefault){return}var b=a.pop();e=e||{};var d=(e.duration===undefined)?200:e.duration;var f=function(g){if(e.closeCallback){e.closeCallback(g)}jQuery(g).remove()};if(b){var c=b.data("anim");if(b.hasClass("bd-dialog-wrapper-small")){jQuery(".bd-dialog-container",b).animate(c.close,c.closeDuration,c.closeEasing,function(){f(b)})}else{b.addClassAnim("bd-dialog-wrapper-close",100,"swing",f)}if(be.closeCurrentDialogCallback!=null){be.closeCurrentDialogCallback();be.closeCurrentDialogCallback=null}if(a.length==0){be.modalsClosed=true;jQuery(".bd-closeIcon").hide();jQuery(".dashBoardTitle").fadeIn("fast");jQuery(".bd-page-index").fadeIn("fast")}if(b.hasClass("standAlone")&&jQuery(this).hasClass("bd-closeIcon")){be.closeAllDialog(e)}}return false};be.closeAllDialog=function(a){while(be.dialogContainersStack.length&&!be.modalsClosed){be.closeCurrentDialog(a)}};window.bd=window.bd||{};window.bd.utils=window.bd.utils||{};(function(){var b="Unknown error produced by the portal client",a="Check the server logs.",d="Error",e="Bad Request",f="Ajax Error",c="Connection timeout! CXP Manager will attempt to abort the action";be.utils.sessionExpireErrorHandler=function(g){location.replace(bd.contextRoot+"/login/loginDashboard.jsp?login_error=timeOut")};be.utils.serverErrorHandler=function(g,h){if(g!=null&&g.indexOf("<html>")!==-1){g=(h!=null)?h:a}bc.component.notify({icon:"error",message:g})};be.utils.commonErrorHandler=function(h){be.closeAllDialog({duration:0,closeModalsOnly:true});var g={title:h.title||d,message:h.message,closeIcon:(h.closeIcon&&h.closeIcon===false)?false:true,respondToEscKey:(h.respondToEscKey&&h.respondToEscKey===false)?false:true,buttons:h.buttons||[{title:"OK"}]};bc.component.dialog(g)};be.utils.connectionErrorHandler=function(){var h,i,g;if(!be.utils.serverErrorHandlerDisplay){h={contextRoot:bd.contextRoot,detailsContent:c};i=be.utils.processHTMLTemplate("errors/serverError",h);g=false;if(i){setTimeout(function(){if(g){be.closeCurrentDialog({showBackground:true})}else{be.modalsClosed=false;be.closeAllDialog({duration:0});jQuery(".bc-modal-dialog").hide();jQuery("#main-nav").hide()}be.openDialog({htmlContent:i,small:true,standAlone:g,respondToEscKey:false});jQuery(".bd-closeIcon").hide()},300);be.utils.serverErrorHandlerDisplay=true}else{location.reload()}}};be.utils.oldJajax=jQuery.ajax;be.utils.ajaxOverwrite=function(){jQuery.ajax=function(g){g.complete=function(h,i){if(i==="timeout"){if(h.abortedByClient){delete h.abortedByClient}else{be.utils.sessionExpireErrorHandler()}}};return be.utils.oldJajax(g)}};be.utils.portalClientErrorHandler=function(g){var h;if(g&&g.request){h=g.request.getResponseHeader("Content-Type")}if(h!=null&&h.indexOf("text/html")!==-1&&g.request.responseText&&g.request.responseText.indexOf("j_spring_security_check")!==-1){be.utils.sessionExpireErrorHandler()}else{if(g==null||g.request==null||g.request.getResponseHeader){be.utils.serverErrorHandler(b)}else{be.utils.serverErrorHandler(g.request.responseText)}}};be.utils.ajaxErrorHandler=function(j,k,i,h){var g=be.utils.getErrorText(j);if((j.status===400&&k===f&&i===e)||(j.status===409&&k===f)){if(be.utils.errorHolder!=null){be.utils.errorHolder(j,g,i)}else{be.utils.serverErrorHandler(g,i)}}else{if(g&&g.indexOf("j_spring_security_check")!==-1){be.utils.sessionExpireErrorHandler(be.utils.sessionExpiryParameters||{})}else{if(j.status===204||j.status===201||(j.status===0&&jQuery.browser.msie)){if(be.utils.success){be.utils.success}else{if(j.success){j.success("",k,j)}}}else{if(k==="error"&&be.utils.errorHolder!=null){be.utils.errorHolder(j,k,i)}else{if(g){be.utils.serverErrorHandler(g,i,h)}else{be.utils.serverErrorHandler()}}}}}}}());var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,c=function(f,e){f=String(f);e=e||2;while(f.length<e){f="0"+f}return f};return function(i,v,q){var g=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){v=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i)){throw SyntaxError("invalid date")}v=String(g.masks[v]||v||g.masks["default"]);if(v.slice(0,4)=="UTC:"){v=v.slice(4);q=true}var t=q?"getUTC":"get",l=i[t+"Date"](),e=i[t+"Day"](),j=i[t+"Month"](),p=i[t+"FullYear"](),r=i[t+"Hours"](),k=i[t+"Minutes"](),u=i[t+"Seconds"](),n=i[t+"Milliseconds"](),f=q?0:i.getTimezoneOffset(),h={d:l,dd:c(l),ddd:g.i18n.dayNames[e],dddd:g.i18n.dayNames[e+7],m:j+1,mm:c(j+1),mmm:g.i18n.monthNames[j],mmmm:g.i18n.monthNames[j+12],yy:String(p).slice(2),yyyy:p,h:r%12||12,hh:c(r%12||12),H:r,HH:c(r),M:k,MM:c(k),s:u,ss:c(u),l:c(n,3),L:c(n>99?Math.round(n/10):n),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:q?"UTC":(String(i).match(b)||[""]).pop().replace(d,""),o:(f>0?"-":"+")+c(Math.floor(Math.abs(f)/60)*100+Math.abs(f)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return v.replace(a,function(m){return m in h?h[m]:m.slice(1,m.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(a,b){return dateFormat(this,a,b)};(function(c){var b={radius:0,duration:600,showShadows:false,shadow:0,useCanvas:true,zIndex:"1000",before:null,after:null};var a=function(o){this.options=o;o.styles=[];var j=function(t,q){var z=jQuery(q);if(!z.length){return{}}var u,s,x,r,w=function(A,C,F){var B=(jQuery(C).length?jQuery(C):z),E=B.css(A),G=(E===undefined||E===null?"":E.replace("px","")),D=parseInt(G,10);return isNaN(D)?!F?G:0:D},v=w("backgroundColor");v=(v=="rgba(0, 0, 0, 0)"||v=="transparent"?"#fff":v);u=z.offset().top||w("top");if(u=="auto"){z.parents().each(function(){var A=jQuery(this);u=jQuery(A).offset().top||w("top",A);if(u!="auto"){return false}})}s=z.offset().left||w("left");if(s=="auto"){z.parents().each(function(){var A=jQuery(this);s=jQuery(A).offset().left||w("left",A);if(s!="auto"){return false}})}var p=z.width()+w("padding-left",null,true)+w("padding-right",null,true)+w("borderLeftWidth",null,true)+w("borderRightWidth",null,true);var y=z.height()+w("padding-top",null,true)+w("padding-bottom",null,true)+w("borderTopWidth",null,true)+w("borderBottomWidth",null,true);o.styles[t]={top:u,left:s,width:p,height:y,bgColor:v,radius:w("borderTopLeftRadius")};return o.styles[t]};o.current=0;var g=jQuery("#canvasFlip3D")[0];if(!g){jQuery("body").append('<canvas id="canvasFlip3D" width="1" height="1" style="display:none; position:absolute; top:0; left:0; z-index:'+o.zIndex+';"></canvas>');g=jQuery("#canvasFlip3D")[0]}var f=false,k=false;if(o.useCanvas&&g.getContext){f=g.getContext("2d")}else{k=jQuery('<div id="divFlip3D" style="display: none; position: absolute; top:-10px; left: 0; z-index:'+o.zIndex+'"></div>');k.appendTo("body")}var n=function(r,s){var p,t,q;if(r&&r.length){f.clearRect(0,0,g.width,g.height);f.beginPath();for(q in r){p=r[q][0]+s.left;t=r[q][1]+s.top;if(q){f.lineTo(p,t)}else{f.moveTo(p,t)}}f.closePath();f.fillStyle=o.bgColor;f.fill();f.lineWidth=o.radiusAnim*2;f.lineJoin="round";f.strokeStyle=o.bgColor;f.stroke()}};var l=function(r){var p,s,q;if(r&&r.length){k.css({width:Math.abs(r[1][0]-r[0][0])})}};var h=function(p){return p>0?1:-1};var e=function(p,u){var s=[];for(var t=0;t<3;t++){var q=0;for(var r=0;r<4;r++){q+=p[t][r]*u[r]}s[t]=q}return s};var m=function(z,p){var r=(o.radiusAnim?o.radiusAnim:o.radius);var s=z.angle,G=false;var F=[],E=[],y=[],x=[],L,J,I,H;var t,q,w,v=0.2,M=0;t=z.xwidth/2;if(o.useCanvas&&f){t-=r}t=t<1?1:t;w=[[1,0,0,0],[0,1,0,0],[0,0,1,0]];q=z.xheight/2-r;if(k){k.css({height:z.xheight,borderRadius:r})}F[0]=t*Math.cos(s+Math.PI);F[1]=q;F[2]=t*Math.sin(s+Math.PI);F[3]=1;E[0]=t*Math.cos(s);E[1]=q;E[2]=t*Math.sin(s);E[3]=1;y[0]=t*Math.cos(s);y[1]=-q;y[2]=t*Math.sin(s);y[3]=1;x[0]=t*Math.cos(s+Math.PI);x[1]=-q;x[2]=t*Math.sin(s+Math.PI);x[3]=1;L=e(w,F);J=e(w,E);I=e(w,y);H=e(w,x);L[1]+=Math.abs(F[2]*v)*h(F[1]);J[1]-=Math.abs(F[2]*v)*h(E[1]);I[1]-=Math.abs(y[2]*v)*h(x[1]);H[1]+=Math.abs(y[2]*v)*h(y[1]);o.radiusAnim=Math.abs(J[0]-L[0])/t/2*z.radius;var u={left:z.xleft+z.xwidth/2,top:z.xtop+z.xheight/2};if(f){n([L,J,I,H],u);if(J[0]-L[0]<0){o.bgColor=o.nextBg}}else{k.css({marginTop:z.xtop-p.top+"px",marginLeft:(t-Math.abs(J[0]-L[0])/2)+z.xleft-p.left+"px"});if(J[0]-L[0]<0){k.css({backgroundColor:o.nextBg})}l([L,J,I,H])}};var i=function(u){var r=c.extend({},o,u||{});o.next=o.queue.length>o.current+1?o.current+1:0;var v=o.current,y=o.queue.eq(v),t=o.next,q=o.queue.eq(t);var x=j(v,y),s=j(t,q);o.bgColor=x.bgColor;o.nextBg=s.bgColor;var w=c.extend(jQuery("<div>")[0],{xtop:x.top,xleft:x.left,xwidth:x.width,xheight:x.height,angle:0,radius:r.radius||x.radius,customAnimate:true,updated:true});if(k){k.show().css({left:x.left+"px",top:x.top+"px",width:x.width+"px",height:x.height+"px",backgroundColor:x.bgColor})}if(c.isFunction(r.before)){r.before(y,q)}if(g){g.width=jQuery(window).width();g.height=jQuery(document).height();jQuery(g).show()}jQuery(w).animate({angle:Math.PI,xtop:s.top,xleft:s.left,xwidth:s.width,xheight:s.height,radius:r.radius||s.radius},{duration:r.duration,complete:function(){if(g){jQuery(g).hide()}if(k){k.hide()}if(c.isFunction(r.after)){r.after(y,q)}o.radiusAnim=false;w.updated=false;o.current=o.next}});var p=function(){if(!w.updated){return}m(w,x);requestAnimFrame(p)};p()};this.next=function(p){i(p);return this};return false};c.fn.canvasFlip=function(e){var f=c.extend({queue:this},b,e||{});return new a(f)};var d=c.fx.step._default;c.fx.step._default=function(e){if(!e.elem.customAnimate){return d(e)}e.elem[e.prop]=e.now;e.elem.updated=true};window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f,e){window.setTimeout(f,1000/60)}})()})(jQuery);jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function(b,c){b.support.transition=(function(){var e=document.body||document.documentElement,f=e.style,d=f.transition!==c||f.WebkitTransition!==c||f.MozTransition!==c||f.MsTransition!==c||f.OTransition!==c;return d})();var a=function(g,h,f,j,i){var d=["add","remove","toggle"];var e=this;if(b.isFunction(i)){if(b.support.transition){this.bind("webkitTransitionEnd transitionend MSTransitionEnd oTransitionEnd",function(k){k.stopImmediatePropagation();i(this)})}else{setTimeout(function(){i(e)},f)}}if(b.support.transition){b.each(d,function(k,l){if(g==l){return e[g+"Class"](h)}})}else{setTimeout(function(){b.each(d,function(k,l){if(g==l){e[g+"Class"](h)}})},f/5);return e}};b.fn.extend({addClassAnim:function(f,e,h,g){var d=this;setTimeout(function(){return e?a.apply(d,["add",f,e,h,g]):d.addClass(f)},1);return this},removeClassAnim:function(e,d,g,f){return d?a.apply(this,["remove",e,d,g,f]):this.removeClass(e)},toggleClassAnim:function(e,d,g,f){return d?a.apply(this,["toggle",e,d,g,f]):this.toggleClass(e)}})})(jQuery);window.be=window.be||{};be.perspective=be.perspective||{};be.perspective.Manager=(function(){var b=function(d){jQuery(d.htmlNode).css({display:"none"});be.closeCurrentDialogCallback=function(){d.setPerspective("Widget")};be.openDialog({standAlone:true,htmlContent:d.body,header:d.model.getPreference("Title"),className:"aa-maximized",closeIcon:true,callback:function(e){return}})};var c=function(e,f){if(f){for(var d=0;d<e.htmlAreas.length;d++){e.htmlAreas[d].style.display="none"}}else{for(var d=0;d<e.htmlAreas.length;d++){e.htmlAreas[d].style.display="";if(e.body.parentNode!==e.htmlNode){jQuery(e.body).insertBefore(jQuery(".bp-widget-foot",e.htmlNode));jQuery(e.htmlNode).css({display:"block"})}}}};var a=function(d){var f,g;try{f=d.target;g=d.newValue;switch(g){case"Maximized":b.call(this,f);break;case"Minimized":c.call(this,f,true);break;case"Widget":c.call(this,f,false);break;default:throw (new Error("Unknown perspective "+g))}}catch(h){console.log("Unable to set perspective: "+h.message)}};return{behaviors:{PerspectiveModified:a}}})();window.be=window.be||{};be.enableSwitch=function(f,e){if(typeof f==="string"){f=jQuery("#"+f)}var c="aa-toggle-checked";var d,a,b;f.each(function(){var g=jQuery(this);var i=function(j){if(j){a.addClass(c)}else{a.removeClass(c)}};if(g.is('input[type="checkbox"]')){d=g;var h=d.attr("checked")=="checked";d.wrap('<p class="field aa-toggle-switch"><label></label></p>');a=d.closest("label");b=d.closest("p.aa-toggle-switch")}else{a=f.find("label");d=f.find('input[type="checkbox"]');b=f}a.append('<span class="aa-toggle-mask"></span>');d.click(function(j){i(this.checked);d.attr("checked",this.checked);if(e){e(jQuery(this))}});i(d.attr("checked")=="checked")});return b};be.toggleDropdown=function(b){var a=this;if(jQuery(this).hasClass("aa-specialDropDown")){return}if(jQuery(".aa-dropdown",this).slideToggle("fast",function(){if(jQuery(this).is(":hidden")){jQuery(a).removeClass("aa-open")}}).is(":visible")){jQuery(a).addClass("aa-open")}if(typeof b=="object"){jQuery(".aa-dropdowncheckbox.aa-open").not(this).each(be.toggleDropdown);b.stopImmediatePropagation()}};be.toggleDropdownInit=function(){if(!be.dropdownInitDone){jQuery(document.body).delegate(".aa-dropdowncheckbox,.aa-slideupcheckbox","click",be.toggleDropdown);jQuery(document.body).bind("click",function(){jQuery(".aa-dropdowncheckbox.aa-open").each(be.toggleDropdown)});jQuery(document.body).delegate(".aa-dropdowncheckbox .aa-checkbox, .aa-slideupcheckbox .aa-checkbox","click",function(a){jQuery(document.body).trigger("click.dropDown");a.stopPropagation()});be.dropdownInitDone=true}};window.be=window.be||{};be.animation=be.animation||{};var loadFlipEffect=function(a,d){var b=jQuery("#overlay");if(!b.length){jQuery("body").append('<div id="overlay" class="overlay"></div>');b=jQuery("#overlay");b.on("click",function(){closeFlipContainer(a)})}b.css({opacity:0}).animate({opacity:0.2},300).show();var f=jQuery("#flip3DContainer");if(!f.length){jQuery("body").append('<div class="aa-FlipBoxContainer" id="flip3DContainer" style="display: none;"></div>');f=jQuery("#flip3DContainer");f.on("keyup",function(g){if(g.keyCode==27){closeFlipContainer(a)}})}f.html(d);repositionContainer();jQuery(window).bind("resize",repositionContainer);var c=0;var e=a.add(f);f.show().css({marginTop:-10,opacity:1}).animate({marginTop:0},200,"linear");a.data("flip",e)};var repositionContainer=function(){var b=jQuery("#flip3DContainer");var a=(jQuery(window).height()-b.height())/2;b.css({left:(jQuery(window).width()-b.width())/2,top:(a>10?a:10)})};var closeFlipContainer=function(a){var b=jQuery("#overlay");b.animate({opacity:0},0,function(){b.hide();b.remove()});if(a.data("flip")){$(a.data("flip")[1]).animate({marginTop:10,opacity:0},200,"linear",function(){$(a.data("flip")[1]).hide();a.removeData("flip")})}};be.animation.flipContainer=(function(){var b=null,c=false;var d=function(){if(b){closeFlipContainer(b);b=null}be.animation.flipContainer.shown=false};var a=function(e,f){b=jQuery(e);f.addEventListener("closePreferenceForm",d);loadFlipEffect(b,jQuery(f.getDisplay()));be.animation.flipContainer.shown=true};return{show:a,hide:d,reposition:repositionContainer,shown:c}})();window.be=window.be||{};be.forms=be.forms||{};be.forms.Preferences=(function(){var a=b$.view.preferences.UserPreferenceField;var b=a.extend();b.prototype.createHTML=function(e){var d=this.model.name;var f=this.model.label?this.model.label:d;var g=jQuery("<tr><td>"+f+'\n</td><td class="portalManagerPreferenceField-fieldHolder"></td><td></td></tr>',e);g.find(".portalManagerPreferenceField-fieldHolder").append(this.createFieldHTML(e));this.html=g.get(0)};b.prototype.createUserInputElement=function(m){var o=this.model;var e=o.name;var s=bd.uiEditingOptions&&bd.uiEditingOptions.widgetPreferenceSelections?bd.uiEditingOptions.widgetPreferenceSelections[e]:null;if(o.dataType.options){s={};for(var j=0,g=o.dataType.options.length;j<g;j++){s[o.dataType.options[j].label]=o.dataType.options[j].value}}var q=o.value;var n;if(o.dataType.getName()==="boolean"){var d=jQuery('<input id="'+e+'_checkbox" type="checkbox"'+(q?' checked="checked"':"")+' name="'+e+'" />');n=be.enableSwitch(d,function(i){var l=i.get(0).checked;setTimeout(function(){o.value=l},200)});return n.get(0)}else{if(s){this.refresh=true;var t=[],p=q;for(var k in s){if(s[k]==q){p=k}t.push({title:k,val:s[k],selected:s[k]==q})}var f={name:e,value:p,options:t};var r='<div><select class="aa-widgetPreferenceDropdown aa-dropdown-{{name}}"{{#id}} id="{{id}}"{{/id}}{{#name}} name="{{name}}"{{/name}}{{#style}} style="{{style}}"{{/style}}>				{{#options}}<option value="{{val}}"{{#selected}} selected="selected"{{/selected}}>{{title}}</option>{{/options}}</select>				<div class="aa-dropdowncheckbox aa-button aa-buttonGradientGrey aa-roundCorner5 aa-widgetPreferenceDropdownUI">				<div class="aa-label aa-label-{{name}}">{{value}}</div>				<div class="aa-dropdown aa-roundCorner8 aa-shadow" for="aa-dropdown-{{name}}" forlabel="aa-label-{{name}}">				{{#options}}<a title="{{val}}" value="{{val}}" class="aa-option{{#selected}} aa-option-selected{{/selected}}"><span class="aa-dropdown-label">{{title}}</span></a>{{/options}}</div></div></div>';var h=Mustache.to_html(r,f);n=jQuery(h);n.find(".aa-option").click(function(){var l=jQuery(this);var i=l.parent(".aa-dropdown");i.children().removeClass("aa-option-selected");l.addClass("aa-option-selected");var v=l.find(".aa-dropdown-label").text();var u=l.attr("title");var w=jQuery("."+i.attr("for"),n).val(u);i.parent().siblings("select."+i.attr("for")).val(u);jQuery("."+i.attr("forlabel"),n).text(v);setTimeout(function(){o.value=u},200)});be.toggleDropdownInit();n=c(n,o);return n.get(0)}else{return a.prototype.createUserInputElement.call(this,m)}}};b.prototype.update=function(d,e){if(this.model.getPreference().getDataType() instanceof BooleanDataType||this.refresh){View.prototype.update.call(this,d,e)}else{b.prototype.update.call(this,d,e)}};var c=function(j,h){var e=null;for(var g=0,d=j.length;g<d;g++){if(jQuery(j[g]).hasClass("aa-dropdowncheckbox")){e=jQuery(j[g]);break}}if(!e){return j}var f=function(i,l){if(!i.length){return}jQuery(".widget-preferences-list").unbind("scroll").bind("scroll",function(m){f(jQuery(".aa-specialDropDown.aa-open"),m)});var k=i[0].dropDownClone;if(k.slideToggle("fast",function(){i[0].dropDownClone.css("overflow","auto");if(k.is(":hidden")){i.removeClass("aa-open");k.remove();i[0].dropDownClone=null}}).is(":visible")){i.addClass("aa-open")}if(typeof l=="object"){jQuery(".aa-specialDropDown.aa-open").not(i).each(function(){f(jQuery(this))});l.stopImmediatePropagation()}};e.bind("click",function(o){if(e[0].dropDownClone){return}e.addClass("aa-specialDropDown");var k=e.children(".aa-dropdown");var l=k.clone();e[0].dropDownClone=l;var n=e.position();var q=e.height();var i=e.width();i=i<200?200:i;var m=l.attr("forlabel");var r=l.attr("for");var p=e.siblings("select."+r).val();l.css({position:"absolute",top:(n.top+q+3)+"px",left:(n.left-7)+"px",right:(i+10)+"px","z-index":"1001","max-height":"100px",overflow:"auto",width:"auto"}).addClass("aa-specialDropDown-dropdown");$('<div class="aa-dropdowncheckbox aa-button aa-buttonGradientGrey aa-widgetPreferenceDropdownUI " style="border:none;height:0;width:0;padding:0;margin:0;position:static;display:block;z-index:-999;"></div>').append(l).appendTo($(".aa-PreferenceEditor"));l.find(".aa-option").removeClass("aa-option-selected");l.find('.aa-option[value="'+p+'"]').addClass("aa-option-selected");f(e,o);l.find(".aa-option").bind("click",function(u){var t=jQuery(this);var s=t.parent(".aa-dropdown");s.children().removeClass("aa-option-selected");t.addClass("aa-option-selected");var w=t.find(".aa-dropdown-label").text();var v=t.attr("title");var x=jQuery("."+s.attr("for"),j).val(v);e.siblings("select."+s.attr("for")).val(v).trigger("change");e.children("."+s.attr("forlabel")).text(w);setTimeout(function(){h.value=v},200);f(e,u)})});jQuery(document.body).unbind("click.specialDropDown").bind("click.specialDropDown",function(i){f(jQuery(".aa-specialDropDown.aa-open"),i)});return j};return{UserPreferenceField:b}})();window.be=window.be||{};be.portalClientExt=(function(){var d=be.animation.flipContainer,a;var e=function(g){var f;if(window.ActiveXObject){f=new ActiveXObject("Microsoft.XMLDOM");f.async="false";f.loadXML(g)}else{var h=new DOMParser();f=h.parseFromString(g,"text/xml")}return f};var c=function(){be.utils.loadCSSByUrl("/static/backbase.com.2012.aurora/css/preferences.css");var h={status:"active"};if(this.params){h={itemName:this.parentNode.getPreference("title")||this.parentNode.model.localName,status:"active",showPermissionAndTargeting:this.showPermissions,showTargeting:this.params.targeting,showTesting:this.params.testing}}var g='            <form class="portal-userPreferencesForm-{{status}} aa-hideIfStylesheetAbsent" ng-controller="PreferencesFormCtrl as ctrl">                <div class="aa-form-header">{{itemName}}</div>                <div class="aa-PreferenceEditor">                    <div class="aa-columnHeader aa-tabLabels" pagename="{{pageName}}">                        <div class="aa-tabLabel aa-tab1 aa-activeTab" for=".aa-tab1">Settings</div>                            {{#showPermissionAndTargeting}}<div class="aa-tabLabel aa-tab2" for=".aa-tab2">Permissions</div>{{/showPermissionAndTargeting}}                            {{#showTargeting}}<div class="aa-tabLabel aa-tab3" for=".aa-tab3">Targeting</div>{{/showTargeting}}                            {{#showTesting}}<div class="aa-tabLabel aa-tab4" for=".aa-tab4">Testing Goals</div>{{/showTesting}}                            {{#showTesting}}<div class="aa-tabLabel aa-tab5" for=".aa-tab5">Testing Results</div>{{/showTesting}}                        </div>                    <div class="aa-tabs">                        <div class="aa-tab aa-tab1 aa-activeTab">                            <div id="PreferenceEditorContent">                                <div class="widget-preferences-list">                                    <table class="bp-pref-table">                                        <tbody class="portalManagerPreferenceFieldView">                                        </tbody>                                    </table>                                </div>                                <div class="aa-buttons">                                    <button class="portal-userPreferencesForm-okButton aa-button aa-buttonGradientGreen aa-roundCorner3 --act" data-action="save" onclick="if (event) event.returnValue = false; return false;">Save</button>                                    <button class="portal-userPreferencesForm-cancelButton aa-buttonText aa-buttonGradientGrey --act" data-action="cancel" onclick="if (event) event.returnValue = false; return false;">Cancel</button>                                </div>                            </div>                        </div>                        {{#showPermissionAndTargeting}}<div class="aa-tab aa-tab2">                            <div id="editWidgetTabs_Permissions" class="editWidgetTabs_Permissions bd-permissionForm"></div>                        </div>{{/showPermissionAndTargeting}}                        {{#showTargeting}}<div class="aa-tab aa-tab3">                            <div id="editWidgetTabs_Targeting" class="editWidgetTabs_Targeting bd-targetingForm"></div>                        </div>{{/showTargeting}}                        <div class="aa-tab aa-tab4">                            <div id="editWidgetTabs_testGoals" class="editWidgetTabs_testGoals bd-testGoalsForm"></div>                        </div>                        <div class="aa-tab aa-tab5">                            <div id="editWidgetTabs_testResults" class="editWidgetTabs_testResults bd-testResults"></div>                        </div>                    </div>                </div>            </form>';var k=Mustache.to_html(g,h);var j=jQuery(k)[0];var f=this;if(j.attachEvent){j.attachEvent("onsubmit",function(l){l.returnValue=false;f.dispatchCustomEvent("save")})}var i=jQuery("#flip3DContainer");i.find(".aa-tabLabels .aa-tab2").click(function(l){if(!jQuery("#editWidgetTabs_Permissions .aa-permissionForm").length){loadWidgetPermission(vc)}});this.htmlBody=b$._private.htmlAPI.findCaptureClass("bp-pref-table",j)[0];return j};var b={};b.behaviors={"preferences-form":function(l){var f,n=false,m=null,k,h=null,i;try{f=l.detail.context;i=f&&f.myDefinition&&!f.processed;n=l.detail.permissions;m=l.detail.callback;h=l.detail.params;if(i){f.updateByDefinition(g.bind(this))}}catch(j){f=this}if(!i){g.call(this)}function g(){var o=this.ownerDocument.createElementNS("http://backbase.com/2012/view","PreferenceForm");if(this.pf&&this.pf.childNodes){this.pf.destroy()}this.pf=o;this.pf.viewContext=f;o.showPermissions=n;o.params=h;o.createDisplay=function(){var r=c.apply(this,arguments);this.htmlNode=r;this.htmlNode.viewController=this};var q=l.detail.customPrefsModel?l.detail.customPrefsModel:b$.portal.portalModel.filterPreferences(f.model.preferences.array);for(var p=0;p<q.length;p++){if(f.helpTexts&&f.helpTexts[q[p].name]){q[p].helpText=f.helpTexts[q[p].name]}if(q[p].name=="widgetChrome"&&q[p].inputType.options.length===0){q[p].inputType.name="select-one";q[p].inputType.options=[{label:"No Chrome",value:"$(contextRoot)/static/backbase.com.2012.aurora/html/chromes/widget_none.html"},{label:"Default Chrome",value:"$(contextRoot)/static/backbase.com.2012.aurora/html/chromes/widget_default.html"}]}}o.getRowTemplate=function(r){return'<tr class="xbp-userPreferenceField"><td class="bp-pref-td-label"><label class="bp-pref-label" for="{{name}}">{{label}}</label></td><td class="bp-pref-td-info">{{#helpText}}<i class="bi bi-pm-square-info bc-ttip-bottom-right"><span class="bc-align-left" style="width: 316px"><p>{{helpText.text}}</p>{{#helpText.link}}<a href="{{helpText.link}}" class="bc-doc-link" target="_blank">Learn more...</a>{{/helpText.link}}</span></i>{{/helpText}}</td><td class="bp-pref-td-input"></td></tr>'};o.insertDisplayChild=function(r,v){var t={},u;if(r.model){t={name:r.model.name,label:(r.model.label)?r.model.label:r.model.name,helpText:r.model.helpText};u=jQuery(Mustache.to_html(this.getRowTemplate(),t))[0];jQuery(".bp-pref-td-input",u).append(r.htmlNode)}else{u=r.htmlNode}var s=b$._private.htmlAPI.findCaptureClass("portalManagerPreferenceFieldView",this.htmlNode)[0];s.appendChild(u)};o.buildFieldsFromPreferences(q,l.target.model);l.target.appendChild(o);o.dispatchCustomEvent("preferenceFormReady",true,true);d.show(f.htmlNode,o);if(f.customPreferencesCallback){f.customPreferencesCallback()}if(m){m()}}l.stopPropagation()},preferenceFormReady:function(f){var h,i,k,g=$(f.target.htmlNode);h=b$.portal.portalModel.filterPreferences(f.target.parentNode.model.preferences.array);a=a||e($('script[type="text/backbase-xml"]').contents().text());var j=function(n){var l=function(){var q=$.data(n,"linkref"),o={};try{o.id=q.link.uuid;o.name=q.link.properties.title.value}catch(p){o=null}return[o]};bc.component.tokenize({field:n,zindex:20000,tokenLimit:1,placeholder:"Drag a link from the tree or start typing",prePopulate:l(),animateDropdown:false,url:bd.contextRoot+"/portals/"+(bd.selectedPortalName||top.bd.selectedPortalName)+"/pagemanagement/search/suggestions",onAdd:function(o){n.val(o.id).closest(".xbp-userPreferenceField").next().find("input").add("button").first().focus()},onDelete:function(){n.focus().val()},onReady:function(){var o=n.prev(".token-input-list:first");o.bdDrop({drop:function(s,r){var p=r.helper.bdDragData.link;var q=["page","menuHeader"];if($.inArray(p.itemtype,q)>=0||$.inArray(p.properties.itemType.value,q)>=0){n.tokenInput("clear");n.tokenInput("add",{id:p.uuid,name:p.linkTitle})}}})},resultsFormatter:function(o){return o&&"<li>"+o.name+"</li>"},tokenFormatter:function(o){return o&&'<li class="bd-man bc-tokenized bc-linkref-token" title="'+o.name+'">'+o.name+"</li>"},onResult:function(q){var r=bd.xmlToJson({xml:q}).suggestions;var o=r.suggestion;var p=[];if(o instanceof Array){p=o}else{if(!$.isEmptyObject(o)){p.push(o)}}return p.map(function(s){return{id:s.uuid,name:s.title}})}});var m=$("#token-input-");m.on("focus",function(){g.find(".bc-select.bc-select-open").each(function(o,p){p.viewController.toggle()})});m.on("blur focus",function(){$(this).css("width","100%")})};if(h instanceof Array){h.filter(function(l){return l.dataType.name==="linkref"||l.dataType.name==="linkRef"}).map(function(l){var m=$('input[name="'+l.name+'"]',g);if(m.length){m.removeClass("bc-input-text--input").closest("span.bc-input-text").css({display:"block"});i=$(a).find("linkEntry").filter(function(){return $(this).find("key").text()===l.name&&$(this).find("link > uuid").text()===l.value}).get(0);if(i){k=be.xmlToJson({xml:i});$.data(m,"linkref",k)}}return m}).forEach(j)}},savePreferenceForm:function(h){var l=this;var i=false,j=false;if(h.detail){if(h.detail.widgetChrome&&h.target.itemModel.getPreference("widgetChrome")!==h.detail.widgetChrome){i=true}if(h.detail.templateUrl&&h.target.itemModel.getPreference("templateUrl")!==h.detail.templateUrl){j=true}}for(var g in h.detail){h.target.itemModel.setPreference(g,h.detail[g])}var f=b$.portal.portalModel.getElementsByTagName("Page")[0].name;var k=h.target;k.itemModel.save(function(){var m=k.parentNode;m.dispatchCustomEvent("preferencesSaved",true,true,{isWidgetChromeChanged:i});if(j||i){j=i=false;m.refreshHTML()}$.ajax({url:bd.contextRoot+"/portals/"+(bd.selectedPortalName||top.bd.selectedPortalName)+"/pages/"+f+".xml"}).success(function(n){a=n})},function(){var m=l.model.ownerDocument.createEvent("MutationEvent");m.initMutationEvent("PrefFallback",true,false,null,null,null,null,MutationEvent.MODIFICATION);l.model.dispatchEvent(m,false)})}};return{PortalManagerPreferencesForm:b}}());be.utils.define("be.promise",function(){var b=function(){var e=bd.selectedPortalName||(b$.portal&&b$.portal.portalName)||"";var d=(e)?"/"+e:"";return bd.contextRoot+(d.length?"/portals"+d:"")};var c=function(d){(d=(typeof d==="object")?$.param(d):d||null);return d};var a=function(f){if(typeof f==="undefined"){throw new Error("You must provide a configuration option in order to make the request!")}if(typeof f.url!=="undefined"){f.url=f.url.toString().replace(/\/$/,"");f.url+=(f.extention!==undefined)?f.extention:".xml";if(typeof f.params!=="undefined"){var i,g="?";for(i in f.params){g+=g!=="?"?"&"+i+"="+f.params[i]:i+"="+f.params[i]}f.url+=g}}var e=new $.Deferred(),h,d;h=f.format||"json";d={type:f.type||"GET",dataType:f.htmlDecode?"text":f.dataType||"xml",cache:f.cache||false,data:c(f.data),beforeSend:f.before||$.noop,error:function(){}};$.extend(true,f,d);be.utils.ajax(f).then(function(k,j,l){if(l&&l.status===204){e.resolve(k);return false}var m=k;if($.isXMLDoc(k)){m=(new XMLSerializer()).serializeToString(k)}switch((h||"json")){case"json":k=$.isXMLDoc(k)?bd.xmlToJson({xml:m}):null;break}e.resolve(k)},function(l,k){var j={status:l.status,statusText:l.statusText,errorMessage:k};e.reject(j)}).then(f.after||$.noop,f.after||$.noop);return e.promise()};return{VERSION:"0.0.3",_baseUrl:bd.contextRoot,_getPortalBaseUrl:b,_makeRequest:a}});(function(b,a,c){if(b.be===null){b.be={}}be.utils.loadCSSByUrl("/static/backbase.com.2012.aurora/css/shared.css");be.fireCustomEvent=function(g,e,f){var d=g.createEvent("CustomEvent");d.initCustomEvent(e,true,true,f);g.dispatchEvent(d)};be.Nav=(function(){var d=function(i){var g=jQuery(i).attr("href");var e=jQuery(i).attr("data-linkType");var h=g.replace(b$.portal.config.serverRoot+"/","");switch(e){case"externalLink":if(b.location!=b.parent.location){b.open(g);return false}break;default:break}var f=top?top.jQuery(".bd-iframeContainer"):jQuery(".bd-iframeContainer");if(f.length!==null){if(jQuery("body.bgcolor-main").children(".bd-preview-bar").length>0){f.hide()}}return true};return{URLHandler:d}}());a.getElementsByTagName("html")[0].className+=be.utils.browserDetection();c.observer={addObserver:function(){},notifyObserver:function(){},removeObserver:function(){},getEvtsList:function(){return{}}}}(window,document,bd));if(window.bd==null){bd={}}be.xmlToJson=function(f){var q=f.dataFormatter;var n=f.xml;var k={};if(n.nodeType==1){if(n.attributes.length>0){for(var h=0;h<n.attributes.length;h++){var b=n.attributes.item(h);if(b.nodeValue!=null&&b.nodeValue!=""){k[b.nodeName]=b.nodeValue}if(b.nodeName=="type"&&b.nodeValue.toLowerCase()=="string"&&!n.childNodes.length){return null}}}}else{if(n.nodeType==3&&n.nodeValue!=null&&n.nodeValue!=""){k=n.nodeValue}}if(n.hasChildNodes()){for(var l=0;l<n.childNodes.length;l++){var r=n.childNodes.item(l);var o=r.nodeName;if(o=="#text"){if(r.nodeValue!=null){k=r.nodeValue}break}else{if(o=="properties"){k.properties={};k.propertiesArray=[];for(var a=0;a<r.childNodes.length;a++){var m=r.childNodes.item(a);var d=m.getAttribute("name");var e=be.xmlToJson({xml:m,dataFormatter:q});k.properties[d]=e;k.propertiesArray.push(e)}if(q!=null){q(k)}}else{if(o=="tags"){k.tags={};k.tagArray=[];for(var a=0;a<r.childNodes.length;a++){var m=r.childNodes.item(a);var g=m.getAttribute("type");var e=be.xmlToJson({xml:m,dataFormatter:q});k.tagArray.push(e);k.tags[a]={type:g,value:e}}if(q!=null){q(k)}}else{if(typeof(k[o])=="undefined"){k[o]=be.xmlToJson({xml:r,dataFormatter:q})}else{if(typeof(k[o].length)=="undefined"){var c=k[o];k[o]=[];k[o].push(c)}k[o].push(be.xmlToJson({xml:r,dataFormatter:q}))}}}}}}return k};